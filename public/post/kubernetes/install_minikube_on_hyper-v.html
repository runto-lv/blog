<!DOCTYPE HTML>
<html lang="zh-cn">

<head><title> Hyper-v下安装minikube - Runto的IT技术博客</title><meta name="baidu-site-verification" content="jZRrwlvEpq" />
<meta name="google-site-verification" content="OcQLxKrUrj5A9hpAdCQuoY-K7f5Ja4LUYt35Kxdwq_E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Runto的IT技术博客的博客" />
<meta name="keywords" content="Runto的IT技术博客的博客" />
<meta name="generator" content="Tale" />
<meta name="renderer" content="webkit">
<meta http-equiv="x-dns-prefetch-control" content="on" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="UTF-8">
<link rel="shortcut icon" href="/img/favicon.ico">
<link href="https://cdn.staticfile.org/amazeui/2.7.2/css/amazeui.min.css" rel="stylesheet">

<link rel="stylesheet" href="/css/customui.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">

<style>
.hljs{display:block;overflow-x:auto;padding:0.5em;color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;}.hljs-doctag,.hljs-keyword,.hljs-formula{color:#a626a4}.hljs-section,.hljs-name,.hljs-selector-tag,.hljs-deletion,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-string,.hljs-regexp,.hljs-addition,.hljs-attribute,.hljs-meta-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-variable,.hljs-template-variable,.hljs-type,.hljs-selector-class,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-number{color:#986801}.hljs-symbol,.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:bold}.hljs-link{text-decoration:underline}
</style>
</head>

<body id="blog">
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Runto的IT技术博客的博客</a>
            
        </div>
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    
                    
                    <li class="menu-item">
                    
                    
                    
                    <a class="menu-item-link" href="https://blog.runto.lv/">首页</a>
                    

                    

                    </li>
                    
                    <li class="menu-item">
                    
                    
                    
                    <a class="menu-item-link" href="https://blog.runto.lv/post.html">归档</a>
                    

                    

                    </li>
                    
                    <li class="menu-item">
                    
                    
                    
                    <a class="menu-item-link" href="https://blog.runto.lv/categories.html">分类</a>
                    

                    

                    </li>
                    
                    <li class="menu-item">
                    
                    
                    
                    <a class="menu-item-link" href="https://blog.runto.lv/tags.html">标签</a>
                    

                    

                    </li>
                    
                    <li class="menu-item">
                    
                    
                    
                    <a class="menu-item-link" href="https://blog.runto.lv/about.html">关于</a>
                    

                    

                    </li>
                    
                </ul>
            </div>
        </div>
    </div>
</nav>

    
<header class="intro-header" style="background-image: url('/images/snowgitlabk.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    
                    <h1>Hyper-v下安装minikube</h1>

                    
                    <span class="meta">@Runto的IT技术博客 &nbsp;2019-10-01</span>
                    <div class="tags post-tags">
                        <div class="post-tags">
                            <a href="https://blog.runto.lv/tags/hyper-v.html">Hyper-v</a>
                            <a href="https://blog.runto.lv/tags/windows.html">Windows</a>
                            <a href="https://blog.runto.lv/tags/kubernetes.html">Kubernetes</a>
                            <a href="https://blog.runto.lv/tags/minikube.html">Minikube</a>
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>


    

<div class="container">
    <div class="am-g am-g-fixed blog-fixed">
        <div class="am-u-lg-12 am-u-sm-12">
            <article class="am-article blog-article-p article-trigger">
                <div id="post-content" class="am-article-bd">
                    

<blockquote>
<p>本文参考网址：<a href="https://yq.aliyun.com/articles/221687">https://yq.aliyun.com/articles/221687</a></p>
</blockquote>

<h3 id="1-打开powershell安装hyper-v的所有组件">1. 打开powershell安装hyper-v的所有组件</h3>

<pre><code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All
</code></pre>

<h3 id="2-打开hyper-v管理控制台-新建一个外部的网络-映射到一个物理网卡-虚拟交换机的名称-这里使用-bridge">2.打开hyper-v管理控制台，新建一个外部的网络，映射到一个物理网卡，虚拟交换机的名称，这里使用<code>Bridge</code></h3>

<h3 id="3-下载-minikube-windows-amd64-exe-文件-并重命名为-minikube-exe">3.下载 minikube-windows-amd64.exe 文件，并重命名为 <code>minikube.exe</code></h3>

<p>下载地址</p>

<pre><code>https://github.com/kubernetes/minikube/releases
</code></pre>

<h3 id="4-执行创建hyper-v">4.执行创建hyper-v</h3>

<p>以管理员身份打开powershell过后执行下面的命令</p>

<pre><code> minikube.exe start --image-mirror-country cn --iso-url=https://kubernetes.oss-cn-hangzhou.aliyuncs.com/minikube/iso/minikube-v1.6.0.iso    --registry-mirror=https://ho0aa4tw.mirror.aliyuncs.com     --vm-driver=&quot;hyperv&quot;    --hyperv-virtual-switch=&quot;Bridge&quot;     --memory=4096 --image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers
</code></pre>

<blockquote>
<p>上面这个minikube的最新版本是我写这个文档 时的最新版本，如果要更新的，需要去下载</p>
</blockquote>

<p>上面这个文档里面，是创建一个虚拟机，使用上面的镜像的信息安装一台k8s</p>

<p>安装的过程可能会有文件下载不下来的情况，需要重新下载，已经下载完成的不要删除，再次下载的时候，已经下载的不会再下载，但虚拟机要删除历史文件，删除此文件夹<code>C:\Users\runto.lv\.minikube</code></p>

<p>下载文件的保存路径在下面</p>

<pre><code>C:\Users\runto.lv\.minikube\cache\images\registry.cn-hangzhou.aliyuncs.com\google_containers
</code></pre>

<p>下载kubuctl</p>

<pre><code>https://storage.googleapis.com/kubernetes-release/release/v1.17.0/bin/windows/amd64/kubectl.exe
</code></pre>

<p>配置环境变量，不然minicube dashboard这个命令不能运行,过程省略</p>

<h3 id="5-本机文件复制复制到虚拟机">5.本机文件复制复制到虚拟机</h3>

<p>先在hyper-v里面这台虚拟机的网卡上面，开启来宾服务，然后就可以把文件复制到虚拟机里面</p>

<pre><code>Copy-VMFile -Name minikube -SourcePath 'C:\Users\runto.lv\.minikube\cache\v1.17.2\kubeadm' -DestinationPath '/bin' -FileSource Host

Copy-VMFile -Name minikube -SourcePath 'C:\Users\runto.lv\.minikube\cache\v1.17.2\kubelet' -DestinationPath '/bin' -FileSource Host
</code></pre>

<p>给执行权限</p>

<pre><code>minikube -p minikube ssh &quot;sudo chmod 755 /bin/kubelet&quot;

minikube -p minikube ssh &quot;sudo chmod 755 /bin/kubeadm&quot;
</code></pre>

                </div>
            </article>
            <hr>
        </div>
    </div>
</div>

    <footer class="blog-footer">
    <div class="blog-text-center">© 2019 <a href="/">Runto的IT技术博客</a> 由 
        <a href="https://github.com/gohugoio/hugo" target="_blank">Hugo</a>
         强力驱动
    </div>
</footer>
<script src="https://cdn.staticfile.org/jquery/3.3.1/jquery.slim.min.js"></script>
<script src="https://cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
    var $body=document.body;var $toggle=document.querySelector(".navbar-toggle");var $navbar=document.querySelector("#huxblog_navbar");var $collapse=document.querySelector(".navbar-collapse");var __HuxNav__={close:function(){$navbar.className=" ";setTimeout(function(){if($navbar.className.indexOf("in")<0){$collapse.style.height="0px"}},400)},open:function(){$collapse.style.height="auto";$navbar.className+=" in"}};$toggle.addEventListener("click",function(a){if($navbar.className.indexOf("in")>0){__HuxNav__.close()}else{__HuxNav__.open()}});document.addEventListener("click",function(a){if(a.target==$toggle){return}if(a.target.className=="icon-bar"){return}__HuxNav__.close()});jQuery(document).ready(function(c){var d=1170;if(c(window).width()>d){var b=c(".navbar-custom").height(),a=c(".intro-header .container").height();c(window).on("scroll",{previousTop:0},function(){var e=c(window).scrollTop(),f=c(".side-catalog");if(e<this.previousTop){if(e>0&&c(".navbar-custom").hasClass("is-fixed")){c(".navbar-custom").addClass("is-visible")}else{c(".navbar-custom").removeClass("is-visible is-fixed")}}else{c(".navbar-custom").removeClass("is-visible");if(e>b&&!c(".navbar-custom").hasClass("is-fixed")){c(".navbar-custom").addClass("is-fixed")}}this.previousTop=e;f.show();if(e>(a+41)){f.addClass("fixed")}else{f.removeClass("fixed")}})}});
</script>
<script>
    $(document).ready(function() {
        $('pre code').each(function(i, block) {
            hljs.highlightBlock(block)
        })
        $('table').addClass('am-table')
    });
</script>

</body>

</html>